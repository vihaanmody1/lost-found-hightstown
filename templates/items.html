{% extends "base.html" %}
{% block content %}
<h2>Found Items</h2>

<form class="searchbar" method="get">
  <input name="q" placeholder="Search by keyword..." value="{{ q or '' }}">
  <select name="category">
    <option value="">All Categories</option>
    {% for cat in ["Clothing","Electronics","Accessories","School Supplies","Other"] %}
      <option value="{{ cat }}" {% if category==cat %}selected{% endif %}>{{ cat }}</option>
    {% endfor %}
  </select>
  <button class="btn" type="submit">Search</button>
</form>

<div class="grid">
  {% if items %}
    {% for it in items %}
      <div class="item card">
        <a href="{{ url_for('item_detail', item_id=it['id']) }}">
          {% if it['photo_filename'] %}
            <img alt="Item photo" loading="lazy" src="{{ url_for('uploaded_file', filename=it['photo_filename']) }}">
          {% else %}
            <img alt="No photo" loading="lazy" src="{{ url_for('static', filename='placeholder.png') }}">
          {% endif %}
        </a>
        <div class="item-meta">
          <span class="status {{ it['status'] }}">{{ it['status']|capitalize }}</span>
          {% if it['category'] %}<span class="badge">{{ it['category'] }}</span>{% endif %}
        </div>
        <h3>{{ it['title'] }}</h3>
        {% if it['location_found'] %}<small class="muted">Found at {{ it['location_found'] }}</small>{% endif %}
        <div class="item-actions">
          <a class="btn" href="{{ url_for('item_detail', item_id=it['id']) }}">Details</a>
          <a class="btn secondary" href="{{ url_for('claim_item', item_id=it['id']) }}">Claim</a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="card">
      <p>No items found. Try adjusting your search.</p>
    </div>
  {% endif %}
</div>
{% endblock %}